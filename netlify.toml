[build]
  command = "npm run build"
  publish = "dist"
  functions = "netlify/functions"

# Single Page App routing
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

[build.environment]
  # Use an LTS Node to avoid toolchain mismatches
  NODE_VERSION = "20"
  # Secrets scanner: omit non-sensitive, expected client-side keys
  SECRETS_SCAN_OMIT_KEYS = "VITE_PAYMENT_PROVIDER,VITE_PAYMENT_ENVIRONMENT,SQUARE_ENVIRONMENT,VITE_SUPABASE_URL,VITE_SUPABASE_ANON_KEY,VITE_PAYMENT_PUBLISHABLE_KEY,SQUARE_APPLICATION_ID,VITE_SQUARE_LOCATION_ID"
  # Uncomment to fully disable secrets scanning if your org policy allows it
  # SECRETS_SCAN_ENABLED = "false" 